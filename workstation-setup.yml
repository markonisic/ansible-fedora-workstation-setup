---
- hosts: localhost
  connection: local
  become: true

  tasks:
  - name: Upgrade all packages
    dnf:
      name: "*"
      state: latest

  - name: Enable RPM fusion
    dnf:
      name: 
        - 'https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-38.noarch.rpm'
        - 'https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-38.noarch.rpm'
      state: present
  
  - include: rpm-packages.yml

  - name: Set default shell to ZSH
    user:
      name: markon
      shell: /bin/zsh

  - name: Install Oh My ZSH
    shell: 'sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"'

  - name: Download Powerlevel10k theme
    shell: 'git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k'
